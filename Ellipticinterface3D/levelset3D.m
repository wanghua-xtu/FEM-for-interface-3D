function phi = levelset3D(example,X,r)
%X is a n*3 matrix
%example = uint8(1);
switch example
    case 1
       % phi = dot(X,X,2)-r*r;  
       % phi = X(:,1)-r;
       %phi = dot(X-r,X-r,2)-1000;
       phi = X(:,1)-r;
    case 2
        phi = dot(X,X,2)-r*r;  
    case 3
        phi = dot(X,X,2)-r*r;  
       % phi = X(:,1)-r;
    case 4
        phi = dot(X,X,2)-r*r; 
        
    case 5
        x = X(:,1); y = X(:,2); z = X(:,3);
        phi = -((0.66 - sqrt(x.^2 + y.^2)).^2 + z.^2 - 0.22^2);
    case 6
        x = X(:,1); y = X(:,2); z = X(:,3);
        phi = -((0.66 - sqrt(x.^2 + y.^2)).^2 + z.^2 - 0.22^2); 
    case 7
        r = 0.7;
        center = [1.0, 0, 0; 
                  -1.0, 0, 0; 
                  0.5, 0.866025403784439, 0; 
                  -0.5, 0.866025403784439, 0;
                  0.5,-0.866025403784439, 0;
                  -0.5,-0.866025403784439, 0; 
                  2.0, 0, 0; 
                 -2.0, 0, 0;
                 1.0, 1.73205080756888, 0;
                 -1.0, 1.73205080756888, 0; 
                 -1.0,-1.73205080756888, 0; 
                  1.0,-1.73205080756888, 0];
              phi0= zeros(length(X),12);
              for i = 1:12
                  phi0(:,i)= (X(:,1)-center(i,1)).^2+(X(:,2)-center(i,2)).^2 ...
                              +(X(:,3)-center(i,3)).^2-r*r; 
              end
              phi = min(phi0')';
    case 8
        r = 0.7;
        center = [1.0, 0, 0; 
                  -1.0, 0, 0; 
                  0.5, 0.866025403784439, 0; 
                  -0.5, 0.866025403784439, 0;
                  0.5,-0.866025403784439, 0;
                  -0.5,-0.866025403784439, 0; 
                  2.0, 0, 0; 
                 -2.0, 0, 0;
                 1.0, 1.73205080756888, 0;
                 -1.0, 1.73205080756888, 0; 
                 -1.0,-1.73205080756888, 0; 
                  1.0,-1.73205080756888, 0];
              phi0= zeros(length(X),12);
              for i = 1:12
                  phi0(:,i)= (X(:,1)-center(i,1)).^2+(X(:,2)-center(i,2)).^2 ...
                              +(X(:,3)-center(i,3)).^2-r*r; 
              end
              phi = min(phi0')';           
    case 9
        %心形余弦曲面 
        x = X(:,1); y = X(:,2); z = X(:,3);
       phi = (x.^2 + 9/4*y.^2 + z.^2 - 1).^3 - x.^2.*z.^3 - 9/80*y.^2.*z.^3;
     case 10
        %心形余弦曲面 
       x = X(:,1); y = X(:,2); z = X(:,3);
       phi = (x.^2 + 9/4*y.^2 + z.^2 - 1).^3 - x.^2.*z.^3 - 9/80*y.^2.*z.^3;

       case 11
           x = X(:,1); y = X(:,2); z = X(:,3);
        phi = (x-2).^2+y.^2+z.^2-4;

         case 12
           x = X(:,1); y = X(:,2); z = X(:,3);
        phi = (x-2).^2+y.^2+z.^2-4;
        
    case 13
           x = X(:,1); y = X(:,2); z = X(:,3);
        phi = (x-(2+r)).^2+y.^2+z.^2-4;
    case 14
           x = X(:,1); y = X(:,2); z = X(:,3);
        phi = x-r;  
    case 15
        x = X(:,1); y = X(:,2); z = X(:,3);
        phi = (x-r(1)).^2+(y-r(2)).^2+(z-r(3)).^2-4;    
        
%     case 5
%         x = X(:,1); y = X(:,2); z = X(:,3);
%         phi = ((x.^2+y.^2-1).^2+z.^2).*((x.^2+z.^2-1).^2+y.^2) ...
%               .*((y.^2+z.^2-1).^2+x.^2)-0.075^2*(1+3*(x.^2+y.^2+z.^2)); 
%      case 6
%         x = X(:,1); y = X(:,2); z = X(:,3);
%         phi = ((x.^2+y.^2-1).^2+z.^2).*((x.^2+z.^2-1).^2+y.^2) ...
%               .*((y.^2+z.^2-1).^2+x.^2)-0.075^2*(1+3*(x.^2+y.^2+z.^2));
%   case 8
%         x = X(:,1); y = X(:,2); z = X(:,3);
%         f1 = 0.4*z+0.2;
%         f2 = -0.01*(z-1/2).^2 + 0.01*(1/3-1/2)^2 +(0.4*1/3+0.2);
%         f3 = -0.4*z + 0.4*2/3 -0.01*(2/3-1/2).^2 + 0.01*(1/3-1/2)^2 +(0.4*1/3+0.2);
%         fz = (z<=0 | z> 1).* 0 + (z<1/3 & z >0).*f1 + (z>1/3 & z<2/3).*f2 + (z>2/3 & z<1).*f3 ;
%         phi = x.^2 + y.^2-fz;
%      case 9
%          %摆线曲面
%          x = X(:,1); y = X(:,2); z = X(:,3); a = 0.01; b = 1; 
%          phi = (x.^2+y.^2+z.^2).^2 - 2*a*z.*(x.^2+y.^2+z.^2) + a^2.*z.^2 - b.^2.*(x.^2+y.^2);
%          
%     case 10
%         %路易斯曲面
%         x = X(:,1); y = X(:,2); z = X(:,3); a = 0.1; b = 0.01; 
%         phi = x.^2.*y.^2 + y.^2.*z.^2 + z.^2.*x.^2 - a*(x.^2+y.^2+z.^2) + b;
%     case 12
%         x = X(:,1); y = X(:,2); z = X(:,3);
%         phi = (x).^2+(y+1).^2+z.^2-r^2;
end

